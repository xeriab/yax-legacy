!function(t){"use strict";Y.extend(Y.Settings.DOM,{router:{defaultPath:"/",before:Y.noop,on:Y.noop,notFound:Y.noop}});var e,n=Y.Settings.DOM.router,r=Y.loc;e={routes:[],current:null,previous:null,hashRegex:{hashStrip:/^#!*/,namedArgument:/:([\w\d]+)/g,argumentSplat:/\*([\w\d]+)/g,escape:/[\-\[\]{}()+?.,\\\^$|#\s]/g},config:function(t){var r;for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return e},history:{cache:!1,support:Y.hasOwn.call(t,"history")},array:function(t){return Y.G.Slice.call(t,0)},go:function(t){return r.hash=t,e},back:function(t){return e.previous?(history.back(),e.previous=null):t&&(r.hash=t),e},proxy:function(t){var e,n=this;return e=function(){return t.apply(n,arguments)}},proxyAll:function(){var t,e=this.array(arguments);for(t=0;t<e.length;t++)this[e[t]]=this.proxy(this[e[t]])},add:function(t,e){var n,r;if(Y.isObject(t))for(n in t)t.hasOwnProperty(n)&&this.add(n,t[n]);else Y.isString(t)&&(t=t.replace(this.hashRegex.escape,"\\$&").replace(this.hashRegex.namedArgument,"([^/]*)").replace(this.hashRegex.argumentSplat,"(.*?)"),r=new RegExp("^"+t+"$")),this.routes.push({Route:r,Function:e||function(){return!1}})},setup:function(e){return e&&e.history&&(this.history.cache=this.history.support&&e.history),this.history.cache?Y.DOM(t).bind("popstate",this.change):Y.DOM(t).bind("hashchange",this.change),this.proxyAll("change"),this.change()},unbind:function(){this.history?Y.DOM(t).unbind("popstate",this.change):Y.DOM(t).unbind("hashchange",this.change)},navigate:function(){var t,e=this.array(arguments),n=!1;Y.isBool(e[e.length-1])&&(n=e.pop()),t=e.join("/"),this.Path!==t&&(n||(this.Path=t),this.history.cache?history.cache.pushState({},Y.doc.title,this.getHost()+t):r.hash=t)},match:function(t,e,n){var r,h=e.exec(t);return h?(r=h.slice(1),n.apply(n,r),!0):!1},getPath:function(){return r.pathname},getHash:function(){return r.hash},getHost:function(){return(Y.doc.location+Y.empty()).replace(this.getPath()+this.getHash(),"")},getFragment:function(){return this.getHash().replace(this.hashRegex.hashStrip,"")},change:function(){var t,r,h,a,s=e.history.cache?e.getPath():e.getFragment(),i=e.getHash(),o=!1,u=e.current;if(s!==e.Path){for(e.Path=s,i||(i=n.defaultPath),u&&u!==e.previous&&(e.previous=u),e.current=i,t=0,r=e.routes.length;r>t&&!o;t++)if(h=e.routes[t],e.match(s,h.Route,h.Function))return;for(t=0,r=e.routes.length;r>t&&!o;t++)h=e.routes[t],Y.isString(s)?s.toLowerCase()===i.toLowerCase().slice(1)&&(n.before.call(e,s),h.Function.call(e),n.on.call(e,s),o=!0):(a=i.match(s),a&&(n.before.call(e,s,a),h.Function.apply(e,a),n.on.call(e,s,a),o=!0));return o||n.notFound.call(e),e}}},Y.DOM.router=e}(this);