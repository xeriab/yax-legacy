!function(t){"use strict";Y.Extend(Y.Settings.DOM,{Router:{DefaultPath:"/",Before:Y.Lang.Noop,On:Y.Lang.noop,NotFound:Y.Lang.Noop}});var e,n=Y.Settings.DOM.Router,r=Y.Location;e={Routes:[],Current:null,Previous:null,HashRegex:{HashStrip:/^#!*/,NamedArgument:/:([\w\d]+)/g,ArgumentSplat:/\*([\w\d]+)/g,Escape:/[\-\[\]{}()+?.,\\\^$|#\s]/g},Config:function(t){var r;for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return e},History:{Cache:!1,Support:Y.HasOwnProperty.call(t,"history")},Array:function(t){return Array.prototype.slice.call(t,0)},Go:function(t){return r.hash=t,e},Back:function(t){return e.Previous?(history.back(),e.Previous=null):t&&(r.hash=t),e},Proxy:function(t){var e,n=this;return e=function(){return t.apply(n,arguments)}},proxyAll:function(){var t,e=this.Array(arguments);for(t=0;t<e.length;t++)this[e[t]]=this.Proxy(this[e[t]])},Add:function(t,e){var n,r;if(Y.Lang.isObject(t))for(n in t)t.hasOwnProperty(n)&&this.Add(n,t[n]);else Y.Lang.isString(t)&&(t=t.replace(this.HashRegex.Escape,"\\$&").replace(this.HashRegex.NamedArgument,"([^/]*)").replace(this.HashRegex.ArgumentSplat,"(.*?)"),r=new RegExp("^"+t+"$")),this.Routes.push({Route:r,Function:e||function(){return!1}})},Setup:function(e){return e&&e.History&&(this.History.Cache=this.History.Support&&e.History),this.History.Cache?Y.Node(t).bind("popstate",this.Change):Y.Node(t).bind("hashchange",this.Change),this.proxyAll("Change"),this.Change()},Unbind:function(){this.History?Y.Node(t).unbind("popstate",this.Change):Y.Node(t).unbind("hashchange",this.Change)},Navigate:function(){var t,e=this.Array(arguments),n=!1;Y.Lang.isBool(e[e.length-1])&&(n=e.pop()),t=e.join("/"),this.Path!==t&&(n||(this.Path=t),this.History.Cache?history.cache.pushState({},document.title,this.getHost()+t):r.hash=t)},Match:function(t,e,n){var r,a=e.exec(t);return a?(r=a.slice(1),n.apply(n,r),!0):!1},getPath:function(){return r.pathname},getHash:function(){return r.hash},getHost:function(){return(document.location+Y.Lang.empty()).replace(this.getPath()+this.getHash(),"")},getFragment:function(){return this.getHash().replace(this.HashRegex.HashStrip,"")},Change:function(){var t,r,a,o,i=e.History.Cache?e.getPath():e.getFragment(),s=e.getHash(),h=!1,u=e.Current;if(i!==e.Path){for(e.Path=i,s||(s=n.DefaultPath),u&&u!==e.Previous&&(e.Previous=u),e.Current=s,t=0,r=e.Routes.length;r>t&&!h;t++)if(a=e.Routes[t],e.Match(i,a.Route,a.Function))return;for(t=0,r=e.Routes.length;r>t&&!h;t++)a=e.Routes[t],Y.Lang.isString(i)?i.toLowerCase()===s.toLowerCase().slice(1)&&(n.Before.call(e,i),a.Function.call(e),n.On.call(e,i),h=!0):(o=s.match(i),o&&(n.Before.call(e,i,o),a.Function.apply(e,o),n.On.call(e,i,o),h=!0));return h||n.NotFound.call(e),e}}},Y.DOM.Router=e}(this);